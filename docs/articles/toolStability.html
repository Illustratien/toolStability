<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to toolStability • toolStability</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to toolStability">
<meta property="og:description" content="toolStability">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">toolStability</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/toolStability.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Illustratien/toolStability/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to toolStability</h1>
                        <h4 data-toc-skip class="author">Tien-Cheng Wang</h4>
            
            <h4 data-toc-skip class="date">2022-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Illustratien/toolStability/blob/HEAD/vignettes/toolStability.Rmd" class="external-link"><code>vignettes/toolStability.Rmd</code></a></small>
      <div class="hidden name"><code>toolStability.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The package <code>toolStability</code> is a collection of functions which implements various methods for describing the <code>stability</code> of a <code>trait</code> in terms of <code>genotype</code> and <code>environment</code>.</p>
<p>The goal of this vignette is to introduce the users to these functions and get started in describing sequentially recorded germination count data. This document assumes a basic knowledge of <code>R</code> programming language.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed using the following functions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install from CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'toolStability'</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Install development version from Github</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Illustratien/toolStability"</span><span class="op">)</span></code></pre></div>
<p>Then the package can be loaded using the function</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Illustratien/toolStability" class="external-link">toolStability</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="welcome-to-toolstability">Welcome to toolStability<a class="anchor" aria-label="anchor" href="#welcome-to-toolstability"></a>
</h2>
<p>This is an r package for calculating parametric, non-parametric, and probabilistic stability indices.</p>
</div>
<div class="section level2">
<h2 id="structure-overview-of-toolstability">Structure overview of toolStability<a class="anchor" aria-label="anchor" href="#structure-overview-of-toolstability"></a>
</h2>
<p>toolStability contains different functions to calculate stability indices, including:</p>
<ol style="list-style-type: decimal">
<li>adjusted coefficient of variation</li>
<li>coefficient of determination</li>
<li>coefficient of regression</li>
<li>deviation mean squares</li>
<li>ecovalence</li>
<li>environmental variance</li>
<li>genotypic stability</li>
<li>genotypic superiority measure</li>
<li>safety first index</li>
<li>stability variance</li>
<li>variance of rank </li>
</ol>
</div>
<div class="section level2">
<h2 id="build-in-data-set">Build-in data set<a class="anchor" aria-label="anchor" href="#build-in-data-set"></a>
</h2>
<p>The default data set <code>Data</code> is the subset of <span class="math inline">\(APSIM\)</span> simulated wheat data set, which includes 5 genotypes in 4 locations for 4 years, with 2 nitrogen application rates, 2 sowing dates, and 2 <span class="math inline">\(CO_2\)</span> levels of treatments <span class="citation">(<a href="#ref-casadebaig2016" role="doc-biblioref">Casadebaig et al., 2016</a>)</span>.</p>
<p><code>Data</code> in this package is a data frame with 640 observations and 8 variables.</p>
<table class="table">
<caption>Data Structure</caption>
<thead><tr class="header">
<th align="left">Parameters</th>
<th align="right">Number</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Trait</td>
<td align="right"></td>
<td align="left">Wheat yield (<span class="math inline">\(kg~ha^{-1}\)</span>).</td>
</tr>
<tr class="even">
<td align="left">Genotype</td>
<td align="right">5</td>
<td align="left">varieties.</td>
</tr>
<tr class="odd">
<td align="left">Environment</td>
<td align="right">128</td>
<td align="left">unique combination of environments for each genotype.</td>
</tr>
<tr class="even">
<td align="left">Year</td>
<td align="right">4</td>
<td align="left">years.</td>
</tr>
<tr class="odd">
<td align="left">Sites</td>
<td align="right">4</td>
<td align="left">locations.</td>
</tr>
<tr class="even">
<td align="left">Nitrogen</td>
<td align="right">2</td>
<td align="left">nitrogen application levels.</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(CO_2\)</span></td>
<td align="right">2</td>
<td align="left">
<span class="math inline">\(CO_2\)</span> concentration levels.</td>
</tr>
<tr class="even">
<td align="left">Sowing</td>
<td align="right">2</td>
<td align="left">sowing dates.</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="toolStability_files/figure-html/plot-1.png" alt="Example of environmental effects on wheat yield." width="768"><p class="caption">
Example of environmental effects on wheat yield.
</p>
</div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Data preparation</li>
</ol>
<p>In order to calculate stability index, you will need to prepare a data frame with 3 columns containing <code>trait</code>, <code>genotype</code>, and <code>environment</code>. <br><br></p>
<ul>
<li>
<code>trait</code>: numeric and continuous, trait value to be analyzed.</li>
<li>
<code>genotype</code>: character or factor, labeling different genotypic varieties.</li>
<li>
<code>environment</code>: character or factor, labeling different environments.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Input formats of function</li>
</ol>
<p>Most of the functions in the package work with the following format:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(<span class="at">data =</span> Data,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">trait =</span> <span class="st">"Trait_Column_Name"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">genotype =</span> <span class="st">"Genotype_Column_Name"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">environment =</span> <span class="st">"Environment_Column_Name"</span>)</span></code></pre></div>
<p>For calculation of probabilistic stability index <code>safety_first_index</code>, an additional parameter <code>lambda</code> is required.<br><br></p>
<p><code>lambda</code>: minimal acceptable value of <code>trait</code> that the user expected from crop across <code>environment</code>. <code>lambda</code> should between the range of <code>trait</code> value.<br><br></p>
<p>Under the assumption of <code>trait</code> is normally distributed, safety first index is calculated based on the probability of trait below <code>lambda</code> across the <code>environment</code> for each <code>genotype</code>.<br><br></p>
<ol start="3" style="list-style-type: decimal">
<li>Function Features</li>
</ol>
<p>Function<code>table_stability</code> generates the summary table containing all the stability indices in the package for every genotypes, also including the mean <code>trait</code> value and normality check results for the <code>trait</code> of each <code>genoytpe</code> across all the <code>enviornment</code>. <br><br></p>
<p>User can specify the interested combination of environments by entering a vector of column names which containing environmental factors. Option <code>normalize = TRUE</code> allow user to compare between different stability indices. Option <code>unit.correct = TRUE</code> is designed for getting the square root value of stability indices which have the squared unit of <code>trait</code>. For function <code>ecovalence</code>, option <code>modify = TRUE</code> takes the number of environments into account and make <code>modified ecovalence</code> comparable between different number of environments.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Illustratien/toolStability" class="external-link">toolStability</a></span><span class="op">)</span>
<span class="co">### load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Data"</span><span class="op">)</span>
<span class="co">### check the structure of sample dataset</span>
<span class="co">### be sure that the trait is numeric!!!</span>



<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span>
<span class="co">#&gt; Rows: 640</span>
<span class="co">#&gt; Columns: 8</span>
<span class="co">#&gt; $ Genotype    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 1864, 1864, 1864, 1864, 1864, 1864, 1864, 1864, 1864~</span>
<span class="co">#&gt; $ Yield       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1278.6, 1746.0, 1753.9, 1851.8, 2176.6, 2783.3, 3113.3, 27~</span>
<span class="co">#&gt; $ Environment <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1959 Emerald low control early, 1960 Emerald low control e~</span>
<span class="co">#&gt; $ Years       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1959, 1960, 1961, 1962, 1959, 1960, 1961, 1962, 1959, 1960~</span>
<span class="co">#&gt; $ Sites       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Emerald, Emerald, Emerald, Emerald, Yanco, Yanco, Yanco, Y~</span>
<span class="co">#&gt; $ Nitrogen    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> low, low, low, low, low, low, low, low, low, low, low, low~</span>
<span class="co">#&gt; $ CO2         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> control, control, control, control, control, control, cont~</span>
<span class="co">#&gt; $ Sowing      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> early, early, early, early, early, early, early, early, ea~</span>

<span class="co">### calculate ecovalence for all genotypes</span>
<span class="va">single.index.ecovalence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ecovalence.html">ecovalence</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span>,
                                      trait <span class="op">=</span> <span class="st">'Yield'</span>,
                                      genotype <span class="op">=</span> <span class="st">'Genotype'</span>,
                                      environment <span class="op">=</span> <span class="st">'Environment'</span>,
                                      unit.correct <span class="op">=</span> <span class="cn">FALSE</span>,
                                      modify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">### check the structure of result</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">single.index.ecovalence</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 3</span>
<span class="co">#&gt; $ Genotype   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 2757, 2844, 3356, 4885</span>
<span class="co">#&gt; $ Mean.Yield <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2878.070, 1913.365, 2911.395, 3038.426, 2024.919</span>
<span class="co">#&gt; $ ecovalence <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17802705, 27718900, 9365241, 12698454, 24133596</span>

<span class="co">### calculate modified ecovalence for all genotypes</span>
<span class="va">single.index.ecovalence.modified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ecovalence.html">ecovalence</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span>,
                                      trait <span class="op">=</span> <span class="st">'Yield'</span>,
                                      genotype <span class="op">=</span> <span class="st">'Genotype'</span>,
                                      environment <span class="op">=</span> <span class="st">'Environment'</span>,
                                      unit.correct <span class="op">=</span> <span class="cn">FALSE</span>,
                                      modify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">### check the structure of result</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">single.index.ecovalence.modified</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 3</span>
<span class="co">#&gt; $ Genotype            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 2757, 2844, 3356, 4885</span>
<span class="co">#&gt; $ Mean.Yield          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2878.070, 1913.365, 2911.395, 3038.426, 2024.919</span>
<span class="co">#&gt; $ ecovalence.modified <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 139083.63, 216553.91, 73165.94, 99206.67, 188543.72</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### calculate all stability indices for all genotypes</span>
<span class="va">summary.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_stability.html">table_stability</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span>,
                                 trait <span class="op">=</span> <span class="st">'Yield'</span>,
                                 genotype <span class="op">=</span> <span class="st">'Genotype'</span>,
                                 environment <span class="op">=</span> <span class="st">'Environment'</span>,
                                 lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Yield</span><span class="op">)</span>,
                                 normalize <span class="op">=</span> <span class="cn">FALSE</span>,
                                 unit.correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning in table_stability(data = Data, trait = "Yield", genotype = "Genotype", : </span>
<span class="co">#&gt; All of your genotypes didn't pass the Shapiro normality test!</span>
<span class="co">#&gt;  Safety_first Index may not be accurate.</span>
<span class="co">#### warning message means your data structure is not distributed as normal distribution</span>

<span class="co">#### check the structure of result</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">summary.table</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 15</span>
<span class="co">#&gt; $ Genotype                          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 2757, 2844, 3356, 4885</span>
<span class="co">#&gt; $ Mean.Yield                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2878.070, 1913.365, 2911.395, 3038.4~</span>
<span class="co">#&gt; $ Normality                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE</span>
<span class="co">#&gt; $ Safety.first.index                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3523378, 0.6665326, 0.3242059, 0.2~</span>
<span class="co">#&gt; $ Coefficient.of.determination      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.9398731, 0.8270000, 0.9485154, 0.9~</span>
<span class="co">#&gt; $ Coefficient.of.regression         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.1596475, 0.8552736, 1.0316158, 1.1~</span>
<span class="co">#&gt; $ Deviation.mean.squares            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 108789.28, 193280.79, 73052.65, 8677~</span>
<span class="co">#&gt; $ Environmental.variance            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1809327, 1117230, 1418923, 1630384, ~</span>
<span class="co">#&gt; $ Genotypic.stability               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 29248135, 24360429, 14583562, 214768~</span>
<span class="co">#&gt; $ Genotypic.superiority.measure     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 89307.69, 1004043.78, 70091.10, 3048~</span>
<span class="co">#&gt; $ Variance.of.rank                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.770116, 2.281250, 1.561946, 1.7913~</span>
<span class="co">#&gt; $ Stability.variance                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 173448.30, 303582.09, 62720.42, 1064~</span>
<span class="co">#&gt; $ Adjusted.coefficient.of.variation <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50.31578, 47.87130, 44.31829, 46.565~</span>
<span class="co">#&gt; $ Ecovalence                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17802705, 27718900, 9365241, 1269845~</span>
<span class="co">#&gt; $ Ecovalence.modified               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 139083.63, 216553.91, 73165.94, 9920~</span>

<span class="co">### calculate all stability indices for all genotypes</span>
<span class="va">normalized.summary.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_stability.html">table_stability</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span>,
                                            trait <span class="op">=</span> <span class="st">'Yield'</span>,
                                            genotype <span class="op">=</span> <span class="st">'Genotype'</span>,
                                            environment <span class="op">=</span> <span class="st">'Environment'</span>,
                                            lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Yield</span><span class="op">)</span>,
                                            normalize <span class="op">=</span> <span class="cn">TRUE</span>,
                                            unit.correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning in table_stability(data = Data, trait = "Yield", genotype = "Genotype", : </span>
<span class="co">#&gt; All of your genotypes didn't pass the Shapiro normality test!</span>
<span class="co">#&gt;  Safety_first Index may not be accurate.</span>
<span class="co">#### warning message means your data structure is not distributed as normal distribution</span>

<span class="co">#### check the structure of result</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">normalized.summary.table</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 15</span>
<span class="co">#&gt; $ Genotype                          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 2757, 2844, 3356, 4885</span>
<span class="co">#&gt; $ Mean.Yield                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2878.070, 1913.365, 2911.395, 3038.4~</span>
<span class="co">#&gt; $ Normality                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE</span>
<span class="co">#&gt; $ Safety.first.index                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.85683453, 0.00000000, 0.93355270, ~</span>
<span class="co">#&gt; $ Coefficient.of.determination      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.07112157, 1.00000000, 0.00000000, ~</span>
<span class="co">#&gt; $ Coefficient.of.regression         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000, 0.9787025, 0.4116811, 0.1~</span>
<span class="co">#&gt; $ Deviation.mean.squares            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7027599, 0.0000000, 1.0000000, 0.8~</span>
<span class="co">#&gt; $ Environmental.variance            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000, 0.9389617, 0.5296575, 0.2~</span>
<span class="co">#&gt; $ Genotypic.stability               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000, 0.3333003, 1.0000000, 0.5~</span>
<span class="co">#&gt; $ Genotypic.superiority.measure     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.9395799, 0.0000000, 0.9593184, 1.0~</span>
<span class="co">#&gt; $ Variance.of.rank                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8095988, 0.3420919, 1.0000000, 0.7~</span>
<span class="co">#&gt; $ Stability.variance                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5402844, 0.0000000, 1.0000000, 0.8~</span>
<span class="co">#&gt; $ Adjusted.coefficient.of.variation <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000, 0.4075840, 1.0000000, 0.6~</span>
<span class="co">#&gt; $ Ecovalence                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5402844, 0.0000000, 1.0000000, 0.8~</span>
<span class="co">#&gt; $ Ecovalence.modified               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5402844, 0.0000000, 1.0000000, 0.8~</span>

<span class="co">### compare the result from summary.table and normalized.summary.table</span>


<span class="co">### calculate the stability indices only based only on CO2 and Nitrogen environments</span>
<span class="va">summary.table2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_stability.html">table_stability</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span>,
                                  trait <span class="op">=</span> <span class="st">'Yield'</span>,
                                  genotype <span class="op">=</span> <span class="st">'Genotype'</span>,
                                  environment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'CO2'</span>,<span class="st">'Nitrogen'</span><span class="op">)</span>,
                                  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">Yield</span><span class="op">)</span>,
                                  normalize <span class="op">=</span> <span class="cn">FALSE</span>,
                                  unit.correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning in table_stability(data = Data, trait = "Yield", genotype = "Genotype", : </span>
<span class="co">#&gt; All of your genotypes didn't pass the Shapiro normality test!</span>
<span class="co">#&gt;  Safety_first Index may not be accurate.</span>

<span class="co">#### check the structure of result</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">summary.table2</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 15</span>
<span class="co">#&gt; $ Genotype                          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 1864, 2757, 2844, 3356, 4885</span>
<span class="co">#&gt; $ Mean.Yield                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2878.070, 1913.365, 2911.395, 3038.4~</span>
<span class="co">#&gt; $ Normality                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> FALSE, FALSE, FALSE, FALSE, FALSE</span>
<span class="co">#&gt; $ Safety.first.index                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3523378, 0.6665326, 0.3242059, 0.2~</span>
<span class="co">#&gt; $ Coefficient.of.determination      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.161086973, 0.138169855, 0.28644744~</span>
<span class="co">#&gt; $ Coefficient.of.regression         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.1791003, 0.8614393, 1.3780191, 1.3~</span>
<span class="co">#&gt; $ Deviation.mean.squares            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1517867.6, 962862.6, 1012476.1, 1269~</span>
<span class="co">#&gt; $ Environmental.variance            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1809327, 1117230, 1418923, 1630384, ~</span>
<span class="co">#&gt; $ Genotypic.stability               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 213741097, 130745446, 161091101, 189~</span>
<span class="co">#&gt; $ Genotypic.superiority.measure     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3688981, 6251668, 3333615, 3180826, ~</span>
<span class="co">#&gt; $ Variance.of.rank                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2644.454, 1623.286, 2007.764, 2479.2~</span>
<span class="co">#&gt; $ Stability.variance                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2025117, 1102709, 1229740, 1636649, ~</span>
<span class="co">#&gt; $ Adjusted.coefficient.of.variation <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50.31578, 47.87130, 44.31829, 46.565~</span>
<span class="co">#&gt; $ Ecovalence                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 192140367, 121852817, 131532582, 162~</span>
<span class="co">#&gt; $ Ecovalence.modified               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1501096.6, 951975.1, 1027598.3, 1269~</span>

<span class="co">### compare the result from summary.table and summary.table2</span>
<span class="co">### see how the choice of environments affect the data</span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="equation-of-stability-indices">Equation of stability indices<a class="anchor" aria-label="anchor" href="#equation-of-stability-indices"></a>
</h2>
<p>Let <span class="math inline">\(X_{ij}\)</span> represent the observed mean value of the genoptype <span class="math inline">\(i\)</span> in environment <span class="math inline">\(j\)</span>, and let <span class="math inline">\(\bar{X_{i.}}\)</span>, <span class="math inline">\(\bar{X_{.j}}\)</span> and <span class="math inline">\(\bar{X_{..}}\)</span> denote the marginal means of genotype <span class="math inline">\(i\)</span>, environment <span class="math inline">\(j\)</span> and the overall mean, respectively.</p>
<div class="section level3">
<h3 id="adjusted-coefficient-variation">adjusted coefficient variation<a class="anchor" aria-label="anchor" href="#adjusted-coefficient-variation"></a>
</h3>
<p>Adjusted coefficient of variation <span class="citation">(<a href="#ref-doering2018" role="doc-biblioref">Döring &amp; Reckling, 2018</a>)</span> is calculated based on regression function. Variety with low adjusted coefficient of variation is considered as stable. Under the linear model</p>
<p><span class="math display">\[v_{i} = a + b~m_{i}\]</span> where <span class="math inline">\(v_{i}\)</span> is the <span class="math inline">\(log_{10}\)</span> of phenotypic variance and <span class="math inline">\(m_{i}\)</span> is the <span class="math inline">\(log_{10}\)</span> of phenotypic mean. <span class="math display">\[\widetilde{c_{i}} = \frac{1}{\widetilde{\mu_{i}}}  \left [
10^{(2-b)~ m_{i} +(b-2)~ \bar{m}+v_{i}} 
\right ] ^{0.5} \times 100 \% \]</span></p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="coefficient-of-determination">coefficient of determination<a class="anchor" aria-label="anchor" href="#coefficient-of-determination"></a>
</h3>
<p>Coefficient of determination <span class="citation">(<a href="#ref-pinthus1973" role="doc-biblioref">Pinthus, 1973</a>)</span> is calculated based on regression function. Variety with low coefficient of determination is considered as stable. Under the linear model <span class="math display">\[Y =\mu + \beta_{i}~ e_{j} + g_{i} + d_{ij}\]</span> where <span class="math inline">\(Y\)</span> is the predicted phenotypic values, <span class="math inline">\(g_{i}\)</span>, <span class="math inline">\(e_{j}\)</span> and <span class="math inline">\(\mu\)</span> denoting genotypic, environmental and overall population mean, respectively.</p>
<p>The effect of GE-interaction may be expressed as: <span class="math display">\[(ge)_{ij} = \beta_{i}~ e_{j} + d_{ij}\]</span> where <span class="math inline">\(\beta_{i}\)</span> is the coefficient of regression and <span class="math inline">\(d_{ij}\)</span> a deviation.</p>
<p>For <span class="math inline">\(s^{2}_{di}\)</span> and <span class="math inline">\(S_{xi}^{2}\)</span>, see <span class="math inline">\(deviation~mean~squares\)</span> and <span class="math inline">\(environmental~ variance\)</span> for details.</p>
<p>Coefficient of determination may be expressed as: <span class="math display">\[r_{i}^{2} = 1 - \frac{s_{di}^{2}}{s_{xi}^{2}} \]</span></p>
<p>where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> and <span class="math inline">\(\bar{X_{.j}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span> and environment <span class="math inline">\(j\)</span>, respectively. <span class="math inline">\(\bar{X_{..}}\)</span> denote the overall mean of <span class="math inline">\(X\)</span>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="coefficient-of-regression">coefficient of regression<a class="anchor" aria-label="anchor" href="#coefficient-of-regression"></a>
</h3>
<p>Coefficient of regression <span class="citation">(<a href="#ref-finlay1963" role="doc-biblioref">Finlay &amp; Wilkinson, 1963</a>)</span> is calculated based on regression function. Variety with low coefficient of regression is considered as stable. Under the linear model <span class="math display">\[Y =\mu + \beta_{i}~ e_{j} + g_{i} + d_{ij}\]</span> where <span class="math inline">\(Y\)</span> is the predicted phenotypic values, <span class="math inline">\(g_{i}\)</span>, <span class="math inline">\(e_{j}\)</span> and <span class="math inline">\(\mu\)</span> denoting genotypic, environmental and overall population mean, respectively.</p>
<p>The effect of GE-interaction may be expressed as: <span class="math display">\[(ge)_{ij} = \beta_{i}~ e_{j} + d_{ij}\]</span> where <span class="math inline">\(\beta_{i}\)</span> is the coefficient of regression and <span class="math inline">\(d_{ij}\)</span> a deviation.</p>
<p>Coefficient of regression may be expressed as: <span class="math display">\[ b_{i}=1 + \frac{\sum_{j}(X_{ij} -\bar{X_{i.}}-\bar{X_{.j}}+\bar{X_{..}}) ~
(\bar{X_{.j}}- \bar{X_{..}})}{\sum_{j}(\bar{X_{.j}}-\bar{X_{..}})^{2}}\]</span></p>
<p>where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> and <span class="math inline">\(\bar{X_{.j}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span> and environment <span class="math inline">\(j\)</span>, respectively. <span class="math inline">\(\bar{X_{..}}\)</span> denote the overall mean of <span class="math inline">\(X\)</span>. <span class="math inline">\(b_{i}\)</span>is the estimation of <span class="math inline">\(\beta_{i}\)</span>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="deviation-mean-squares">deviation mean squares<a class="anchor" aria-label="anchor" href="#deviation-mean-squares"></a>
</h3>
<p>Deviation mean squares <span class="citation">(<a href="#ref-eberhart1966" role="doc-biblioref">Eberhart &amp; Russell, 1966</a>)</span> is calculated based on regression function. Variety with low stability variance is considered as stable.</p>
<p>Deviation mean squares may be expressed as: <span class="math display">\[
s^{2}_{di} = \frac{1}{E-2} \left [
\sum_{j}~(X_{ij} - \bar{X_{i.}}- \bar{X_{.j}} + \bar{X_{..}}^{2}) - (b_{i} - 1)^{2} ~
(\bar{X_{.j}}- \bar{X_{..}})^{2} \right ]
\]</span></p>
<p>where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> and <span class="math inline">\(\bar{X_{.j}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span> and environment <span class="math inline">\(j\)</span>, respectively. <span class="math inline">\(\bar{X_{..}}\)</span> denote the overall mean of <span class="math inline">\(X\)</span>. <span class="math inline">\(b_{i}\)</span> is the estimation of coefficient of regression.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="ecovalence">ecovalence<a class="anchor" aria-label="anchor" href="#ecovalence"></a>
</h3>
<p>Ecovalence <span class="citation">(<a href="#ref-wricke1962" role="doc-biblioref">Wricke, 1962</a>)</span> is calculated based on square and sum up the genotype–environment interaction all over the environment. Variety with low ecovalence is considered as stable. Ecovalence is expressed as: <span class="math display">\[W_{i} = \sum_{j}~(X_{ij} - \bar{X_{i.}} - \bar{X_{.j}} + \bar{X_{..}}^{2})\]</span> To let <span class="math inline">\(W_{i}\)</span> comparable between experiments, we also provide the modified ecovalence (<span class="math inline">\(W_{i}'\)</span>), whcih take the number of environments into account. User can get (<span class="math inline">\(W_{i}'\)</span>) by setting <code>modify = TRUE</code>.</p>
<p><span class="math display">\[W_{i}' = \frac{\sum_{j}~(X_{ij} - \bar{X_{i.}} - \bar{X_{.j}} + \bar{X_{..}}^{2})}{E-1}\]</span> where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="environmental-variance">environmental variance<a class="anchor" aria-label="anchor" href="#environmental-variance"></a>
</h3>
<p>Environmental variance <span class="citation">(<a href="#ref-roemer1917" role="doc-biblioref">Römer, 1917</a>)</span> is calculated by squared and summing up all deviation from genotypic mean for each genotype. The larger the environmental variance of one genotype is, the lower the stability.</p>
<p><span class="math display">\[S_{xi}^{2} = \frac{\sum_{j}~(X_{ij} - \bar{X_{i.}})^{2}}{E-1} \]</span> where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="genotypic-stability">genotypic stability<a class="anchor" aria-label="anchor" href="#genotypic-stability"></a>
</h3>
<p>Genotypic stability <span class="citation">(<a href="#ref-hanson1970" role="doc-biblioref">Hanson, 1970</a>)</span> is calculated based on regression function. Variety with low stability variance is considered as stable. Under the linear model <span class="math display">\[Y =\mu + \beta_{i}~ e_{j} + g_{i} + d_{ij}\]</span> where <span class="math inline">\(Y\)</span> is the predicted phenotypic values, <span class="math inline">\(g_{i}\)</span>, <span class="math inline">\(e_{j}\)</span> and <span class="math inline">\(\mu\)</span> denoting genotypic, environmental and overall population mean, respectively.</p>
<p>The effect of GE-interaction may be expressed as: <span class="math display">\[(ge)_{ij} = \beta_{i}~ e_{j} + d_{ij}\]</span> where <span class="math inline">\(\beta_{i}\)</span> is the coefficient of regression and <span class="math inline">\(d_{ij}\)</span> a deviation.</p>
<p>Genotypic stability: <span class="math display">\[ D_{i}^{2} = \sum_{j}~(X_{ij} - \bar{X_{i.}}- b_{min}~ \bar{X_{.j}} + b_{min}~ \bar{X_{..}})^{2}\]</span></p>
<p>where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> and <span class="math inline">\(\bar{X_{.j}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span> and environment <span class="math inline">\(j\)</span>, respectively. <span class="math inline">\(\bar{X_{..}}\)</span> denote the overall mean of <span class="math inline">\(X\)</span>.</p>
<p><span class="math inline">\(b_{min}\)</span> is the minimum value of coefficient of regression over all environments.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="genotypic-superiority-measure">genotypic superiority measure<a class="anchor" aria-label="anchor" href="#genotypic-superiority-measure"></a>
</h3>
<p>Genotypic superiority measure <span class="citation">(<a href="#ref-lin1988" role="doc-biblioref">Lin &amp; Binns, 1988</a>)</span> is calculatd based on means square distance between maximum value of environment j and genotype i. Variety with low genotypic superiority measure is considered as stable.</p>
<p><span class="math display">\[P_{i} = \sum_{j}^{n} \frac{(X_{ij}-M_{j})^{2}}{2n}\]</span> where <span class="math inline">\(X_{ij}\)</span> stands for observed trait and <span class="math inline">\(M_{j}\)</span> stands for maximum response among all genotypes in the <span class="math inline">\(j^{th}\)</span> location.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="safety-first-index">safety first index<a class="anchor" aria-label="anchor" href="#safety-first-index"></a>
</h3>
<p>Safety-first index <span class="citation">(<a href="#ref-eskridge1990" role="doc-biblioref">Eskridge, 1990</a>)</span> is calculated based on the normality assumption of trait over the environments. Among different environments, trait below a given critical level <span class="math inline">\(\lambda\)</span> is defined as failure of trait. Safety-first index calculating the probability of trait failure over the environment. Variety with low safety first index is considered as stable.</p>
<p><span class="math display">\[Pr~(Y_{ij} &lt; \lambda) = \Phi \left[
(\lambda - \mu_{i})/ \sqrt \sigma_{ii}
\right]\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is the minimal acceptable value of trait that the user expected from crop across environments. Lambda should between the range of trait value. <span class="math inline">\(\Phi\)</span> is the cumulative distribution function of the standard normal distribution. <span class="math inline">\(\mu_{i}\)</span> and <span class="math inline">\(\sigma_{ii}\)</span> is the mean and variance of the system i. Under the assumption of trait is normally distributed, safety first index is calculated based on the probability of trait below lambda across the environments for each genotype.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="stability-variance">stability variance<a class="anchor" aria-label="anchor" href="#stability-variance"></a>
</h3>
<p>Stability variance <span class="citation">(<a href="#ref-shukla1972" role="doc-biblioref">Shukla, 1972</a>)</span> is calculated based on linear combination of ecovalence and mean square of genotype-environment interaction. Variety with low stability variance is considered as stable.</p>
<p><span class="math display">\[
\sigma^{2}_{i} = \frac{1}{(G-1) ~ (G-2) ~ (E-1)} \left [
G ~(G-1)~ \sum_{j}~(X_{ij} - \bar{X_{i.}}-\bar{X_{.j}} + \bar{X_{..}})^{2}- \sum_{i} \sum_{j}~(X_{ij} - \bar{X_{i.}}-\bar{X_{.j}} + \bar{X_{..}})^{2}
\right ]
\]</span> where <span class="math inline">\(X_{ij}\)</span> is the observed phenotypic mean value of genotype <span class="math inline">\(i\)</span> (i = 1,…, G) in environment <span class="math inline">\(j\)</span> (j = 1,…,E), with <span class="math inline">\(\bar{X_{i.}}\)</span> and <span class="math inline">\(\bar{X_{.j}}\)</span> denoting marginal means of genotype <span class="math inline">\(i\)</span> and environment <span class="math inline">\(j\)</span>, respectively. <span class="math inline">\(\bar{X_{..}}\)</span> denote the overall mean of <span class="math inline">\(X\)</span>.</p>
<p>Negative values of stability variance is replaced with 0.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level3">
<h3 id="variance-of-rank">variance of rank<a class="anchor" aria-label="anchor" href="#variance-of-rank"></a>
</h3>
<p>Variance of rank <span class="citation">(<a href="#ref-nassar1987" role="doc-biblioref">Nassar &amp; Hühn, 1987</a>)</span> is calculated based on regression function. Variety with low variance of rank is considered as stable.</p>
<p>Correction for each genotype <span class="math inline">\(i\)</span> was done by subtraction of marginal genotypic mean <span class="math inline">\(\bar{X_{i.}}\)</span> and the addition of overall mean <span class="math inline">\(\bar{X_{..}}\)</span>. <span class="math display">\[X_{corrected~ij} = X_{ij} - \bar{X_{i.}} + \bar{X_{..}}\]</span> Then calculated the rank all genotypes for each environment <span class="math inline">\(j\)</span> <span class="math display">\[r_{ij} = rank~(X_{correctedij})\]</span></p>
<p>Variance of rank is calculated as the following equation. <span class="math display">\[S_{i}4 = \frac{\sum_{j}~(r_{ij}-\bar{r_{i.}})^{2}}{E-1}\]</span> where <span class="math inline">\(r_{ij}\)</span> is the rank of genotype <span class="math inline">\(i\)</span> in environment <span class="math inline">\(j\)</span> and <span class="math inline">\(\bar{r_{i.}}\)</span> is the marginal rank of genotype <span class="math inline">\(i\)</span> over environment, based on the corrected <span class="math inline">\(X_{ij}\)</span> values.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="citing-toolstability">Citing <code>toolStability</code><a class="anchor" aria-label="anchor" href="#citing-toolstability"></a>
</h2>
<pre><code><span class="co">#&gt; </span>
<span class="co">#&gt; To cite the R package 'toolStability' in publications use:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Wang, T-C. and Chen, T-W. ( 2022 ).  toolStability: Tool for</span>
<span class="co">#&gt;   stability indices calculation.  R package version 0.1.1 ,</span>
<span class="co">#&gt;   https://github.com/Illustratien/toolStability/</span>
<span class="co">#&gt;   https://cran.r-project.org/package=toolStability .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Manual{,</span>
<span class="co">#&gt;     title = {toolStability: Tool for Stability Indices Calculation},</span>
<span class="co">#&gt;     author = {T.-C. Wang and T.-W. Chen},</span>
<span class="co">#&gt;     year = {2022},</span>
<span class="co">#&gt;     note = {R package version 0.1.1},</span>
<span class="co">#&gt;     note = {https://github.com/Illustratien/toolStability/},</span>
<span class="co">#&gt;     note = {https://cran.r-project.org/package=toolStability},</span>
<span class="co">#&gt;   }</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This free and open-source software implements academic research by the</span>
<span class="co">#&gt; authors and co-workers. If you use it, please support the project by</span>
<span class="co">#&gt; citing the package.</span></code></pre>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-casadebaig2016" class="csl-entry">
Casadebaig, P., Zheng, B., Chapman, S., Huth, N., Faivre, R., &amp; Chenu, K. (2016). Assessment of the <span>P</span>otential <span>I</span>mpacts of <span>W</span>heat <span>P</span>lant <span>T</span>raits across <span>E</span>nvironments by <span>C</span>ombining <span>C</span>rop <span>M</span>odeling and <span>G</span>lobal <span>S</span>ensitivity <span>A</span>nalysis. <em>PLOS ONE</em>, <em>11</em>(1), e0146385. <a href="https://doi.org/10.1371/journal.pone.0146385" class="external-link">https://doi.org/10.1371/journal.pone.0146385</a>
</div>
<div id="ref-doering2018" class="csl-entry">
Döring, T. F., &amp; Reckling, M. (2018). Detecting global trends of cereal yield stability by adjusting the coefficient of variation. <em>European Journal of Agronomy</em>, <em>99</em>, 30–36. <a href="https://doi.org/10.1016/j.eja.2018.06.007" class="external-link">https://doi.org/10.1016/j.eja.2018.06.007</a>
</div>
<div id="ref-eberhart1966" class="csl-entry">
Eberhart, S. A., &amp; Russell, W. A. (1966). Stability parameters for comparing varieties. <em>Crop Science</em>, <em>6</em>(1), 36–40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x" class="external-link">https://doi.org/10.2135/cropsci1966.0011183X000600010011x</a>
</div>
<div id="ref-eskridge1990" class="csl-entry">
Eskridge, K. M. (1990). Selection of <span>S</span>table <span>C</span>ultivars <span>U</span>sing a <span>S</span>afety-<span>F</span>irst <span>R</span>ule. <em>Crop Science</em>, <em>30</em>(2), 369. <a href="https://doi.org/10.2135/cropsci1990.0011183X003000020025x" class="external-link">https://doi.org/10.2135/cropsci1990.0011183X003000020025x</a>
</div>
<div id="ref-finlay1963" class="csl-entry">
Finlay, K. W., &amp; Wilkinson, G. N. (1963). The analysis of adaptation in a plant-breeding programme. <em>Australian Journal of Agricultural Research</em>, <em>14</em>(6), 742–754. <a href="https://doi.org/10.1071/AR9630742" class="external-link">https://doi.org/10.1071/AR9630742</a>
</div>
<div id="ref-hanson1970" class="csl-entry">
Hanson, W. D. (1970). Genotypic stability. <em>Theoretical and Applied Genetics</em>, <em>40</em>(5), 226–231. <a href="https://doi.org/10.1007/BF00285245" class="external-link">https://doi.org/10.1007/BF00285245</a>
</div>
<div id="ref-lin1988" class="csl-entry">
Lin, C. S., &amp; Binns, M. R. (1988). A superiority measure of cultivar performance for cultivar <span class="math inline">\(\times\)</span> location data. <em>Canadian Journal of Plant Science</em>, <em>68</em>(1), 193–198. Retrieved from <a href="https://cdnsciencepub.com/doi/10.4141/cjps88-018" class="external-link">https://cdnsciencepub.com/doi/10.4141/cjps88-018</a>
</div>
<div id="ref-nassar1987" class="csl-entry">
Nassar, R., &amp; Hühn, M. (1987). Studies on estimation of phenotypic stability: Tests of significance for nonparametric measures of phenotypic stability. <em>Biometrics</em>, <em>43</em>(1), 45–53.
</div>
<div id="ref-pinthus1973" class="csl-entry">
Pinthus, M. J. (1973). Estimate of genotypic value: A proposed method. <em>Euphytica</em>, <em>22</em>(1), 121–123. <a href="https://doi.org/10.1007/BF00021563" class="external-link">https://doi.org/10.1007/BF00021563</a>
</div>
<div id="ref-roemer1917" class="csl-entry">
Römer, T. (1917). Sind die ertragdreichen <span>S</span>orten ertagissicherer? <em>Mitteilungen Der Deutschen Landwirtschaftlichen Gesellschaft</em>, <em>32</em>(1), 87–89.
</div>
<div id="ref-shukla1972" class="csl-entry">
Shukla, G. K. (1972). Some statistical aspects of partitioning genotype environmental components of variability. <em>Heredity</em>, <em>29</em>(2), 237–245.
</div>
<div id="ref-wricke1962" class="csl-entry">
Wricke, G. (1962). Über eine <span>M</span>ethode zur <span>E</span>rfassung der ökologischen <span>S</span>treubreite in <span>F</span>eldversuchen. <em>Zeitschrift Für Pflanzenzüchtung</em>, <em>47</em>, 92–96.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tien-Cheng Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
